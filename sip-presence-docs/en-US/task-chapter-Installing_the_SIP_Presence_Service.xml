<?xml version='1.0'?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" []>
<!-- chapter id nickname: itsps -->
<chapter id="itsps-Installing_the_SIP_Presence_Service">
	<title>Installing the SIP Presence Service</title>
	
	<xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="mob-task-section-Java_Development_Kit-Installing_Configuring_and_Running.xml"/>
	
	<section id="itsps-binary-SIP_Presence_Service-Installing_Configuring_and_Running">
		<title>Mobicents SIP Presence Service: Installing, Configuring and Running</title>
		<para>There are multiple distributions of the <application>Mobicents SIP Presence Service</application>.</para>
		<variablelist id="itsps-Description_of_the_Different_SIP_Presence_Service_Distributions">
			<title>Description of the Different SIP Presence Service Distributions</title>
			<varlistentry>
				<term>The zipped-up source distribution</term>
				<listitem>
					<para>This distribution is source only, and its installation is not covered in this guide. Be careful you don't accidentally download this distribution when wanting one of the binary distributions (this one has <filename>.src</filename> in its file name).</para>
				</listitem>
			</varlistentry>
			<varlistentry>
				<term>The all-included integrated <application>SIP Presence Service</application> binary distribution <emphasis>with JBoss</emphasis>
				</term>
				<listitem>
					<para>These installation instructions detail the installation, running and configuring of the all-included <emphasis>integrated</emphasis> binary <application>SIP Presence Service</application> distribution. In addition to the <application>XML Document</application> and <application>SIP Presence Servers</application>, this distribution bundles the <application>JBoss Application Server</application>, the latest version of the <application>Mobicents JAIN SLEE Server</application>, and the SIP and HTTP Servlet resource adapters.</para>
				</listitem>
			</varlistentry>
			<varlistentry>
				<term>The integrated <application>SIP Presence Service</application> binary distribution <emphasis>without</emphasis> JBoss</term>
				<listitem>
					<para>Users who have already installed and set up a separate <application>Mobicents JAIN SLEE Server</application> installation may want to install this the integrated distribution without JBoss. If you install this distribution, keep in mind that the <envar>JBOSS_HOME</envar> environment variable <emphasis>must</emphasis> be set to the correct location.</para>
				</listitem>
			</varlistentry>
			<varlistentry>
				<term>The <application>XML Document Management</application> Server binary distribution with <application>JBoss</application>
				</term>
				<listitem>
					<para>Users who wish to deploy the <application>XML Document Server</application> on a different host or who do not require the <application>SIP Presence Server</application> should install the standalone <application>XDM Server</application> binary distribution. The following installation, running and configuring instructions provide parallel instructions specific to the <application>XDM Server</application>.</para>
				</listitem>
			</varlistentry>
		</variablelist>
		
		<section	id="itms-binary-SIP_Presence_Service-PreInstall_Requirements_and_Prerequisites">
			<title>Pre-Install Requirements and Prerequisites</title>
			<para>Ensure that the following requirements have been met before continuing with the install.</para>
			<variablelist id="itms-binary-SIP_Presence_Service-Hardware_Requirements">
				<title>Hardware Requirements</title>
				<varlistentry>
					<term>Sufficient Disk Space</term>
					<listitem>
						<para>Once unzipped, the SIP Presence Service binary release requires <emphasis>at least</emphasis> &SPS_INT_SIZE; of free disk space.  The <application>XDM Server</application> binary release requires <emphasis>at least</emphasis> &SPS_XDMS_SIZE; of disk space.  Keep in mind that disk space requirements may change from release to release.</para>
					</listitem>
				</varlistentry>
				<varlistentry>
					<term>Anything Java Itself Will Run On</term>
					<listitem>
						<para>The SIP Presence Service and its bundled servers, JBoss and JAIN SLEE, are 100% Java. The SIP Presence Service will run on the same hardware that the JBoss Application Server runs on.</para>
					</listitem>
				</varlistentry>
			</variablelist>
			<variablelist id="itms-binary-SIP_Presence_Service-Software_Prerequisites">
				<title>Software Prerequisites</title>
				<varlistentry>
					<term>JDK 5 or Higher</term>
					<listitem>
						<para>A working installation of the Java Development Kit (<acronym>JDK</acronym>) version 5 or higher is required in order to run the SIP Presence Service (or XDM Server).  Note that the JBoss Application Server is a runtime dependency of the SIP Presence Service (or XDM Server) and, as mentioned, comes bundled with the binary distribution.</para>
					</listitem>
				</varlistentry>
			</variablelist>
		</section>
		
		<section id="itms-binary-SIP_Presence_Service-Downloading">
			<title>Downloading</title>
			<para>The latest version of the SIP Presence Service (or XDM Server) is available from <ulink url="http://sourceforge.net/projects/mobicents/files/"/>.  The SIP Presence Service section contains the latest released version at the top of the list.</para>
			<para>To determine which distribution zip file to download, refer to <xref linkend="itsps-Description_of_the_Different_SIP_Presence_Service_Distributions"/>, and the following list of release binaries.</para>
			<variablelist id="itsps-SIP_Presence_Service_Binary_Distribution_Zip_Files">
				<title>SIP Presence Service Binary Distribution Zip Files</title>
				<varlistentry>
					<term>&SPS_INT_ZIP;</term>
					<listitem><para>Download this zip file to obtain the integrated <application>SIP Presence Service</application> binary distribution, which includes the <application>SIP Presence Server</application>, the <application>XDM Server</application>, and the <application>JBoss Application Server</application> as well as all required resource adapters.</para></listitem>
				</varlistentry>
				<varlistentry>
					<term>&SPS_XDMS_ZIP;</term>
					<listitem><para>Download this zip file to obtain the <application>XML Document Management Server</application> binary distribution, which bundles the <application>JBoss Application Server</application> and the <application>Mobicents JAIN SLEE Server</application>.</para></listitem>
				</varlistentry>
			</variablelist>
		</section>
		
		<section	id="itms-binary-SIP_Presence_Service-Installing">
			<title>Installing</title>
			<para>Once the requirements and prerequisites have been met and you have downloaded the binary distribution zip file, you are ready to install the SIP Presence Service (or XDM Server).  Follow the instructions below for your platform, whether Linux or Windows.  Because the instructions for installing both servers are identical, the XDM Server installation commands appear below the SIP Presence Service commands.  Disregard the XDM Server install commands if the SIP Presence Service is only being installed.</para>
			<procedure>
				<title>Installing the SIP Presence Service (or XDM Server) Binary Distribution on Linux</title>
				<para>It is assumed that the downloaded archive is saved in the <filename>/home</filename> directory, and that a terminal window is open displaying the <filename>/home</filename> directory.</para>
				<step>
					<para>Create a subdirectory to extract the files into.  For ease of identification, it is recommended that the version number of the binary is included in this directory name.</para>
					<screen>~]$ mkdir <quote>sps-<replaceable>&lt;version&gt;</replaceable></quote></screen>
					<para>or</para>
					<screen>~]$ mkdir <quote>xdms-<replaceable>&lt;version&gt;</replaceable></quote></screen>
				</step>
				<step>
					<para>Move the downloaded zip file into the directory:</para>
					<screen>~]$ mv <quote>&SPS_INT_ZIP;</quote><quote>sps-<replaceable>&lt;version&gt;</replaceable></quote></screen>
					<para>or</para>
					<screen>~]$ mv <quote>&SPS_XDMS_ZIP;</quote><quote>xdms-<replaceable>&lt;version&gt;</replaceable></quote></screen>
				</step>
				<step>
					<para>Move into the directory:</para>
					<screen>~]$ cd <quote>sps-<replaceable>&lt;version&gt;</replaceable></quote></screen>
					<para>or</para>
					<screen>~]$ cd <quote>xdms-<replaceable>&lt;version&gt;</replaceable></quote></screen>
				</step>
				<step>
				<para>Extract the files into the current directory by executing one of the following commands.
				<itemizedlist>
          <listitem><para>Java: 
            <screen>sps-<replaceable>&lt;version&gt;</replaceable>]$ jar -xvf <quote>&SPS_INT_ZIP;</quote></screen>
            <screen>xdms-<replaceable>&lt;version&gt;</replaceable>]$ jar -xvf <quote>&SPS_XDMS_ZIP;</quote></screen>
          </para></listitem>
				  <listitem><para>Linux: 
				   <screen>sps-<replaceable>&lt;version&gt;</replaceable>]$ unzip &quot;&SPS_INT_ZIP;&quot;</screen>
				   <screen>xdms-<replaceable>&lt;version&gt;</replaceable>]$ unzip &quot;&SPS_XDMS_ZIP;&quot;</screen>
          </para></listitem>

        </itemizedlist>
        <note><para>Alternatively, use <command>unzip</command> -d &lt;unzip_to_location&gt; to extract the zip file's contents to a location other than the current directory.</para></note>
				</para>
				</step>
				<step>
					<para>Consider deleting the archive, if free disk space is an issue.</para>
					<screen>sps-<replaceable>&lt;version&gt;</replaceable>]$ rm <quote>&SPS_INT_ZIP;</quote></screen>
					<para>or</para>
					<screen>xdms-<replaceable>&lt;version&gt;</replaceable>]$ rm <quote>&SPS_XDMS_ZIP;</quote></screen>
				</step>
			</procedure>
			<procedure>
				<title>Installing the SIP Presence Service (or XDM Server) Binary Distribution on Windows</title>
				<step>
					<para>For this procedure, it is assumed that the downloaded archive is saved in the <filename>My Downloads</filename> folder.</para>
				</step>
				<step>
				<para>Create a subfolder in <filename>My Downloads</filename> to extract the zip file's contents into.  For ease of identification, it is recommended that the version number of the binary is included in the folder name.  For example, <filename>sps-&lt;version&gt;</filename> (or for the XDM Server, <filename>xdms-&lt;version&gt;</filename>.</para>
			</step>
			<step>
				<para>Extract the contents of the archive, specifying the destination folder as the one created in the previous step.</para>
      </step>
      <step>
        <para>Alternatively, execute the <command>jar -xvf</command> command to extract the binary distribution files from the zip archive.</para>
        <orderedlist>
          <listitem><para>Move the downloaded zip file from <filename>My Downloads</filename> to the folder created in the previous step.</para></listitem>
          <listitem><para>Open the Windows Command Prompt and navigate to the folder that contains the archive using the <command>cd</command> command.</para></listitem>
          <listitem><para>Execute the <command>jar -xvf</command> command to extract the archive contents into the current folder.</para>
          <screen>C:&bsol;Users&bsol;&lt;user&gt;&bsol;My Downloads&bsol;sps-&lt;version&gt;&bsol;jar -xvf &quot;&SPS_INT_ZIP;&quot;</screen>
          <screen>C:&bsol;Users&bsol;&lt;user&gt;&bsol;My Downloads&bsol;xdms-&lt;version&gt;&bsol;jar -xvf &quot;&SPS_XDMS_ZIP;&quot;</screen>
          </listitem>
        </orderedlist>
      </step>
			<step>
				<para>It is recommended that the folder holding the files (in this example, the folder named <filename>sps-<replaceable>&lt;version&gt;</replaceable></filename> or <filename>xdms-<replaceable>&lt;version&gt;</replaceable></filename>) is moved to a user-defined location for storing executable programs.  For example, the <filename>Program Files</filename> folder.</para>
			</step>
			<step>
				<para>Consider deleting the archive, if free disk space is an issue.</para>
				<screen>C:&bsol;Users&bsol;&lt;user&gt;&bsol;My Downloads&bsol;mss-&lt;version&gt;&bsol;delete &quot;&SPS_INT_ZIP;&quot;</screen>
				<para>or</para>
				<screen>C:&bsol;Users&bsol;&lt;user&gt;&bsol;My Downloads&bsol;xdms-&lt;version&gt;&bsol;delete &quot;&SPS_XDMS_ZIP;&quot;</screen>
			</step>
		</procedure>
		</section>
		
		<xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="mob-task-section-Setting_the_JBOSS_HOME_Environment_Variable.xml"></xi:include>
		
		<section	id="itms-binary-SIP_Presence_Service-Running">
			<title>Running</title>
			<para>In the Linux terminal or Command Prompt, the last line of output is similar to the following (ending with <quote>Started in 23s:648ms</quote>) if the server has started correctly:</para>
			<programlisting><![CDATA[11:23:07,656 INFO  [Server] JBoss (MX MicroKernel) [4.2.2.GA (build: SVNTag=JBoss_4_2_2_GA date=200710221139)] Started in 23s:648ms]]></programlisting>
			<procedure>
				<title>Running the SIP Presence Service (or XDM Server) on Linux</title>
				<step>
				  <para>Change the working directory to installation directory (the one in which the zip file's contents was extracted to)</para>
				  <screen>downloads]$ cd &quot;sps-&lt;version&gt;&quot;</screen>
				  <para>or</para>
				  <screen>downloads]$ cd &quot;xdms-&lt;version&gt;&quot;</screen>
			  </step>
			  <step>
			  	<para>(Optional) Ensure that the <filename>bin/run.sh</filename> start script is executable.</para>
			  	<screen>sps-&lt;version&gt;]$ chmod +x bin/run.sh</screen>
			  	<para>or</para>
			  	<screen>xdms-&lt;version&gt;]$ chmod +x bin/run.sh</screen>
			  </step>
		  	<step>
		  		<para>Execute the <filename>run.sh</filename> Bourne shell script.</para>
	  			<screen>sps-&lt;version&gt;]$ ./bin/run.sh</screen>
	  			<para>or</para>
	  			<screen>sps-&lt;version&gt;]$ ./bin/run.sh</screen>
        </step>
	  	</procedure>
		  <note>
		    <para>Instead of executing the Bourne shell script to start the server, the <filename>run.jar</filename> executable Java archive can be executed from the <filename>bin</filename> directory:</para>
			  <screen>sps-&lt;version&gt;]$ java -jar bin/run.jar</screen>
			  <para>or</para>
			  <screen>xdms-&lt;version&gt;]$ java -jar bin/run.jar</screen>
      </note>
		  <procedure>
		  	<title>Running SIP Presence Service (or XDM Server) on <productname>Windows</productname></title>
	  		<step>
		  		<para>Using Windows Explorer, navigate to the <filename>bin</filename> subfolder in the installation directory.</para>
        </step>
		  	<step>
		  		<para>The preferred way to start the SIP Presence Service (or XDM Server) is from the Command Prompt.  The command line interface displays details of the startup process, including any problems encountered during the startup process.</para>
		  		<para>Open the Command Prompt via the <guilabel>Start</guilabel> menu and navigate to the correct folder:</para>
			  	<screen>C:&bsol;Users&bsol;&lt;user&gt;&bsol;My Downloads&gt; cd &quot;sps-&lt;version&gt;&quot;</screen>
			  	<para>or</para>
			  	<screen>C:&bsol;Users&bsol;&lt;user&gt;&bsol;My Downloads&gt; cd &quot;sps-&lt;version&gt;&quot;</screen>
		  	</step>
       <step>
         <para>Start the JBoss Application Server by executing one of the following files:
         <itemizedlist>
           <listitem>
            <para><filename>run.bat</filename> batch file:</para>
            <screen>C:&bsol;Users&bsol;&lt;user&gt;&bsol;My Downloads&bsol;sps-&lt;version&gt;&gt;bin&bsol;run.bat</screen>
            <screen>C:&bsol;Users&bsol;&lt;user&gt;&bsol;My Downloads&bsol;xdms-&lt;version&gt;&gt;bin&bsol;run.bat</screen>
           </listitem>
           <listitem>
            <para><filename>run.jar</filename> executable Java archive:</para>
            <screen>C:&bsol;Users&bsol;&lt;user&gt;&bsol;My Downloads&bsol;sps-&lt;version&gt;&gt;&bsol;java -jar bin&bsol;run.jar</screen>
            <screen>C:&bsol;Users&bsol;&lt;user&gt;&bsol;My Downloads&bsol;xdms-&lt;version&gt;&gt;&bsol;java -jar bin&bsol;run.jar</screen>
          </listitem>
          </itemizedlist>
          </para>
			</step>
			</procedure>
		</section>
		
		<section	id="itms-binary-SIP_Presence_Service-Stopping">
		  <title>Stopping</title>
			<para>Detailed instructions for stopping the <application>SIP Presence Service</application> and <application>XDM Server</application> are given below, arranged by platform.  If the server is correctly stopped, the following three lines are displayed as the last output in the Linux terminal or Command Prompt:</para>
		  <programlisting>[Server] Shutdown complete
Shutdown complete
Halting VM</programlisting>
		<procedure>
			<title>Stopping the SIP Presence Service (or XDM Server) on Linux</title>
			<step>
				<para>Change the working directory to the binary distribution's install directory.</para>
				<screen>~]$ cd &quot;sps-&lt;version&gt;&quot;</screen>
				<para>or</para>
				<screen>~]$ cd &quot;xdms-&lt;version&gt;&quot;</screen>
			</step>
			<step>
				<para>(Optional) Ensure that the bin/shutdown.sh start script is executable:</para>
				<screen>sps-&lt;version&gt;]$ chmod +x bin/shutdown.sh</screen>
				<para>or</para>
				<screen>xdms-&lt;version&gt;]$ chmod +x bin/shutdown.sh</screen>
			</step>
			<step>
				<para>Run the <filename>shutdown.sh</filename> executable Bourne shell script with the <option>-S</option> option (the short option for <option>--shutdown</option>) as a command line argument:</para>
				<screen>sps-&lt;version&gt;]$ ./bin/shutdown.sh -S</screen>
				<para>or</para>
				<screen>xdms-&lt;version&gt;]$ ./bin/shutdown.sh -S</screen>
			</step>
		</procedure>
		<note><para>The <filename>shutdown.jar</filename> executable Java archive with the <option>-S</option> option can also be used to shut down the server:</para>
      <screen>sps-&lt;version&gt;]$ java -jar bin/shutdown.jar -S</screen>
      <para>or</para>
      <screen>xdms-&lt;version&gt;]$ java -jar bin/shutdown.jar -S</screen>
    </note>
		<procedure>
			<title>Stopping MSS for JBoss on Windows</title>
			<step>
				<para>Stopping the JBoss Application Server on Windows consists of executing either the <filename>shutdown.bat</filename> or the <filename>shutdown.jar</filename> executable file in the <filename>bin</filename> subfolder of the MSS for JBoss binary distribution.  Ensure the <option>-S</option> option (the short option for <option>--shutdown</option>) is included in the command line argument.</para>
				<screen>C:&bsol;Users&bsol;&lt;user&gt;&bsol;My Downloads&bsol;sps-&lt;version&gt;&gt;bin&bsol;shutdown.bat -S</screen>
			</step>
		</procedure>
		<note><para>The <filename>shutdown.jar</filename> executable Java archive with the <option>-S</option> option can also be used to shut down the server:</para>
      <screen>C:&bsol;Users&bsol;&lt;user&gt;&bsol;My Downloads&bsol;ms-&lt;version&gt;&gt;java -jar bin&bsol;shutdown.jar -S</screen>
    </note>
		</section>
		
		
		<section	id="itsps-binary-SIP_Presence_Service-Testing">
			<title>Testing</title>
			<para>&nbsp;</para>
		</section>
		
		
		<section	id="itsps-binary-SIP_Presence_Service-Uninstalling">
			<title>Uninstalling</title>
			<para>To uninstall the <application>SIP Presence Service</application> or <application>XDM Server</application>, delete the installation directory where the archive was extracted to.</para>
		</section>
	</section>
</chapter>